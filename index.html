<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Mini-garden üå±</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; background:#f4f6f5; color:#1c1c1c;}
.container { padding:20px; max-width:420px; margin:0 auto; }
.card { background:#fff; border-radius:16px; padding:16px; margin-bottom:16px; box-shadow:0 8px 20px rgba(0,0,0,0.06);}
.plant-image { width:100%; border-radius:14px; margin-bottom:12px;}
h1 { margin:0 0 8px; font-size:22px;}
.description { font-size:14px; color:#555;}
.care-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px;}
.care-item { background:#f7f9f8; border-radius:12px; padding:12px; font-size:14px;}
.care-item span { display:block; font-size:18px; margin-bottom:4px;}
.button { width:100%; padding:14px; border-radius:14px; border:none; font-size:16px; background:#2ecc71; color:white; cursor:pointer; margin-top:8px;}
.button:active { transform:scale(0.98);}
.status { margin-top:10px; font-size:14px; color:#2ecc71; text-align:center;}
.hidden { display:none; }
select,input[type="radio"] { width:100%; padding:10px; border-radius:10px; font-size:16px; margin-top:8px;}
label { font-size:14px; margin-top:10px; display:block;}
.purchase-option { display:flex; align-items:center; margin-top:10px; background:#f7f9f8; border-radius:12px; padding:10px; cursor:pointer;}
.purchase-option img { width:40px; margin-right:12px; border-radius:8px;}
.purchase-option span { font-size:16px; }
.purchase-option:hover { background:#e0f2e9; }
</style>
</head>
<body>
<div class="container">

<!-- 1. –ï—Å—Ç—å —Ü–≤–µ—Ç–æ–∫ -->
<div class="card" id="havePlantCard">
<h1>–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Ü–≤–µ—Ç–æ–∫?</h1>
<button class="button" id="havePlantYes">–î–∞ üå±</button>
<button class="button" id="havePlantNo">–ù–µ—Ç ‚ùå</button>
</div>

<!-- 2. –í—ã–±–æ—Ä —Ä–∞—Å—Ç–µ–Ω–∏—è, –µ—Å–ª–∏ –µ—Å—Ç—å -->
<div class="card hidden" id="selectPlantCard">
<h1>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ü–≤–µ—Ç–æ–∫</h1>
<select id="plantSelect"></select>
<button class="button" id="selectPlantBtn">–í—ã–±—Ä–∞—Ç—å</button>
</div>

<!-- 3. –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è -->
<div class="card hidden" id="plantCard">
<img id="plantImage" class="plant-image" src="">
<h1 id="plantName"></h1>
<div class="description" id="plantDescription"></div>
<h1>–£—Ö–æ–¥</h1>
<div class="care-grid">
<div class="care-item"><span>üíß</span>–ü–æ–ª–∏–≤: 1‚Äì2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é</div>
<div class="care-item"><span>‚òÄÔ∏è</span>–°–≤–µ—Ç: —è—Ä–∫–∏–π, –±–µ–∑ –ø—Ä—è–º—ã—Ö –ª—É—á–µ–π</div>
<div class="care-item"><span>üêæ</span>–ë–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö</div>
<div class="care-item"><span>üå°Ô∏è</span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 18‚Äì25¬∞C</div>
</div>
<button class="button" id="waterBtn">–Ø –ø–æ–ª–∏–ª —Å–µ–≥–æ–¥–Ω—è üíß</button>
<div class="status" id="statusText"></div>

<!-- –ë–ª–æ–∫ –ø–æ–∫—É–ø–∫–∏ -->
<h1 style="margin-top:16px;">–ö—É–ø–∏—Ç—å</h1>
<div id="purchaseContainer"></div>
</div>

<!-- 4. –¢–µ—Å—Ç –¥–ª—è –Ω–æ–≤—ã—Ö -->
<div class="card hidden" id="testCard">
<h1>–î–∞–≤–∞–π—Ç–µ –ø–æ–¥–±–µ—Ä–µ–º –≤–∞–º —Ü–≤–µ—Ç–æ–∫</h1>
<div class="description">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:</div>

<label>1. –ì–¥–µ –±—É–¥–µ—Ç —Å—Ç–æ—è—Ç—å —Ä–∞—Å—Ç–µ–Ω–∏–µ?</label>
<select id="locationSelect">
<option value="south">üåû –Æ–∂–Ω–æ–µ –æ–∫–Ω–æ</option>
<option value="east">üå§ –í–æ—Å—Ç–æ—á–Ω–æ–µ –æ–∫–Ω–æ</option>
<option value="west">üå• –ó–∞–ø–∞–¥–Ω–æ–µ –æ–∫–Ω–æ</option>
<option value="north">üåë –°–µ–≤–µ—Ä–Ω–æ–µ –æ–∫–Ω–æ</option>
<option value="far">ü™¥ –î–∞–ª–µ–∫–æ –æ—Ç –æ–∫–Ω–∞</option>
</select>

<label>2. –ö–∞–∫–∞—è —É –≤–∞—Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–æ–º–∞?</label>
<select id="tempSelect">
<option value="cold">‚ùÑÔ∏è –ü—Ä–æ—Ö–ª–∞–¥–Ω–æ (–¥–æ 18¬∞C)</option>
<option value="normal">üå° –ù–æ—Ä–º–∞–ª—å–Ω–æ (18‚Äì24¬∞C)</option>
<option value="hot">üî• –ñ–∞—Ä–∫–æ (25¬∞C –∏ –≤—ã—à–µ)</option>
</select>

<label>3. –ö–∞–∫–æ–π —É –≤–∞—Å –æ–ø—ã—Ç —Å —Ä–∞—Å—Ç–µ–Ω–∏—è–º–∏?</label>
<select id="expSelect">
<option value="kill">üòÖ –Ø –æ–±—ã—á–Ω–æ –∏—Ö —É–±–∏–≤–∞—é</option>
<option value="medium">üôÇ –ò–Ω–æ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è</option>
<option value="pro">üòé –Ø —É–≤–µ—Ä–µ–Ω–Ω—ã–π —Ü–≤–µ—Ç–æ–≤–æ–¥</option>
</select>

<label>4. –ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ?</label>
<select id="petsSelect">
<option value="yes">üêæ –î–∞</option>
<option value="no">üö´ –ù–µ—Ç</option>
</select>

<label>5. –ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è?</label>
<select id="reminderSelect">
<option value="min">üîî –ú–∏–Ω–∏–º—É–º</option>
<option value="std">üîîüîî –°—Ç–∞–Ω–¥–∞—Ä—Ç</option>
<option value="max">üîîüîîüîî –ß–∞—Å—Ç–æ</option>
</select>

<button class="button" id="runTestBtn">–ü–æ–¥–æ–±—Ä–∞—Ç—å —Ä–∞—Å—Ç–µ–Ω–∏–µ</button>
</div>

<!-- 5. –í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Ä–∞—Å—Ç–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞ -->
<div class="card hidden" id="choosePlantCard">
<h1>–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç—ã –ø–æ–¥ –≤–∞—à–∏ —É—Å–ª–æ–≤–∏—è</h1>
<select id="suggestedSelect"></select>
<button class="button" id="choosePlantBtn">–í—ã–±—Ä–∞—Ç—å</button>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded", function(){
    const tg = window.Telegram?.WebApp; if(tg) tg.expand();

    const plants = {
        "–ê–ª—å—Å—Ç—Ä–æ–º–µ—Ä–∏—è": {img:"images/alctromeriya.png", desc:"–Ø—Ä–∫–∏–π –Ω–µ–ø—Ä–∏—Ö–æ—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç–æ–∫."},
        "–ë–µ–≥–æ–Ω–∏—è": {img:"images/begoniya.png", desc:"–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —è—Ä–∫–∏—Ö –æ–∫–æ–Ω –∏ –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –ø–∏—Ç–æ–º—Ü–µ–≤."},
        "–ö–æ–ª–µ—É—Å": {img:"images/coleus.png", desc:"–ö—Ä–∞—Å–∏–≤–æ–µ –∏ –Ω–µ–ø—Ä–∏—Ö–æ—Ç–ª–∏–≤–æ–µ –∫–æ–º–Ω–∞—Ç–Ω–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ."},
        "–ì–∞—Ä–¥–µ–Ω–∏—è": {img:"images/gardeniya.png", desc:"–õ—é–±–∏—Ç —è—Ä–∫–∏–π —Å–≤–µ—Ç –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å."},
        "–û—Ä—Ö–∏–¥–µ—è –§–∞–ª–µ–Ω–æ–ø—Å–∏—Å": {img:"images/orfid_falenopsis.png", desc:"–ö—Ä–∞—Å–∏–≤—ã–π –æ—Ä—Ö–∏–¥–µ–π —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —É—Ö–æ–¥–æ–º."},
        "–û—Ä—Ö–∏–¥–µ—è –ö–∞—Ç—Ç–ª–µ—è": {img:"images/orfid_kattleya.png", desc:"–î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤–æ–¥–æ–≤, –ª—é–±–∏—Ç —Å–≤–µ—Ç –∏ —Ç–µ–ø–ª–æ."}
    };

    const purchaseLinks = {
        "–ê–ª—å—Å—Ç—Ä–æ–º–µ—Ä–∏—è": [
            {name:"–ì–æ—Ä—à–æ–∫", img:"images/pot.png", url:"https://www.ozon.ru/product/alstromeriya-pot/"},
            {name:"–°–µ–º–µ–Ω–∞", img:"images/seeds.png", url:"https://www.ozon.ru/product/alstromeriya-seeds/"},
            {name:"–ì—Ä—É–Ω—Ç", img:"images/soil.png", url:"https://www.ozon.ru/product/alstromeriya-soil/"}
        ],
        "–ë–µ–≥–æ–Ω–∏—è": [
            {name:"–ì–æ—Ä—à–æ–∫", img:"images/pot.png", url:"https://www.ozon.ru/product/begoniya-pot/"},
            {name:"–°–µ–º–µ–Ω–∞", img:"images/seeds.png", url:"https://www.ozon.ru/product/begoniya-seeds/"},
            {name:"–ì—Ä—É–Ω—Ç", img:"images/soil.png", url:"https://www.ozon.ru/product/begoniya-soil/"}
        ],
        "–ö–æ–ª–µ—É—Å": [
            {name:"–ì–æ—Ä—à–æ–∫", img:"images/pot.png", url:"https://www.ozon.ru/product/coleus-pot/"},
            {name:"–°–µ–º–µ–Ω–∞", img:"images/seeds.png", url:"https://www.ozon.ru/product/coleus-seeds/"},
            {name:"–ì—Ä—É–Ω—Ç", img:"images/soil.png", url:"https://www.ozon.ru/product/coleus-soil/"}
        ],
        "–ì–∞—Ä–¥–µ–Ω–∏—è": [
            {name:"–ì–æ—Ä—à–æ–∫", img:"images/pot.png", url:"https://www.ozon.ru/product/gardeniya-pot/"},
            {name:"–°–µ–º–µ–Ω–∞", img:"images/seeds.png", url:"https://www.ozon.ru/product/gardeniya-seeds/"},
            {name:"–ì—Ä—É–Ω—Ç", img:"images/soil.png", url:"https://www.ozon.ru/product/gardeniya-soil/"}
        ],
        "–û—Ä—Ö–∏–¥–µ—è –§–∞–ª–µ–Ω–æ–ø—Å–∏—Å": [
            {name:"–ì–æ—Ä—à–æ–∫", img:"images/pot.png", url:"https://www.ozon.ru/product/orfid-falenopsis-pot/"},
            {name:"–°–µ–º–µ–Ω–∞", img:"images/seeds.png", url:"https://www.ozon.ru/product/orfid-falenopsis-seeds/"},
            {name:"–ì—Ä—É–Ω—Ç", img:"images/soil.png", url:"https://www.ozon.ru/product/orfid-falenopsis-soil/"}
        ],
        "–û—Ä—Ö–∏–¥–µ—è –ö–∞—Ç—Ç–ª–µ—è": [
            {name:"–ì–æ—Ä—à–æ–∫", img:"images/pot.png", url:"https://www.ozon.ru/product/orfid-kattleya-pot/"},
            {name:"–°–µ–º–µ–Ω–∞", img:"images/seeds.png", url:"https://www.ozon.ru/product/orfid-kattleya-seeds/"},
            {name:"–ì—Ä—É–Ω—Ç", img:"images/soil.png", url:"https://www.ozon.ru/product/orfid-kattleya-soil/"}
        ]
    };

    const havePlantCard = document.getElementById("havePlantCard");
    const selectPlantCard = document.getElementById("selectPlantCard");
    const testCard = document.getElementById("testCard");
    const plantCard = document.getElementById("plantCard");
    const choosePlantCard = document.getElementById("choosePlantCard");
    const plantSelect = document.getElementById("plantSelect");
    const suggestedSelect = document.getElementById("suggestedSelect");
    const purchaseContainer = document.getElementById("purchaseContainer");

    const savedPlant = localStorage.getItem("currentPlant");
    if(savedPlant && plants[savedPlant]){
        havePlantCard.classList.add("hidden");
        showPlantCard(savedPlant);
        plantCard.classList.remove("hidden");
    }

    // 1. –í—ã–±–æ—Ä –î–∞/–ù–µ—Ç
    document.getElementById("havePlantYes").onclick = ()=>{
        havePlantCard.classList.add("hidden");
        selectPlantCard.classList.remove("hidden");
        plantSelect.innerHTML="";
        for(let p in plants){
            let opt=document.createElement("option"); opt.value=p; opt.innerText=p;
            plantSelect.appendChild(opt);
        }
    };

    document.getElementById("havePlantNo").onclick = ()=>{
        havePlantCard.classList.add("hidden");
        testCard.classList.remove("hidden");
    };

    // 2. –í—ã–±–æ—Ä —Ä–∞—Å—Ç–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞
    document.getElementById("selectPlantBtn").onclick = ()=>{
        const selected = plantSelect.value;
        localStorage.setItem("currentPlant", selected);
        showPlantCard(selected);
        selectPlantCard.classList.add("hidden");
        plantCard.classList.remove("hidden");
    };

    // 3. –ü–æ–¥–±–æ—Ä —Ä–∞—Å—Ç–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç
    document.getElementById("runTestBtn").onclick = ()=>{
        const loc = document.getElementById("locationSelect").value;
        const temp = document.getElementById("tempSelect").value;
        const exp = document.getElementById("expSelect").value;
        const pets = document.getElementById("petsSelect").value;

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π
        let suggested = [];
        if(loc==="south" && pets==="yes") suggested.push("–ë–µ–≥–æ–Ω–∏—è","–ê–ª—å—Å—Ç—Ä–æ–º–µ—Ä–∏—è");
        if(loc==="east" && temp==="normal") suggested.push("–ì–∞—Ä–¥–µ–Ω–∏—è","–ö–æ–ª–µ—É—Å");
        if(loc==="north") suggested.push("–û—Ä—Ö–∏–¥–µ—è –§–∞–ª–µ–Ω–æ–ø—Å–∏—Å");
        if(exp==="pro" && loc==="west") suggested.push("–û—Ä—Ö–∏–¥–µ—è –ö–∞—Ç—Ç–ª–µ—è");
        if(suggested.length===0) suggested.push("–ö–æ–ª–µ—É—Å");

        testCard.classList.add("hidden");
        choosePlantCard.classList.remove("hidden");

        suggestedSelect.innerHTML="";
        suggested.forEach(p=>{
            let opt=document.createElement("option");
            opt.value=p;
            opt.innerText=p;
            suggestedSelect.appendChild(opt);
        });
    };

    // 4. –í—ã–±–æ—Ä —Ä–∞—Å—Ç–µ–Ω–∏—è –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
    document.getElementById("choosePlantBtn").onclick = ()=>{
        const selected = suggestedSelect.value;
        localStorage.setItem("currentPlant", selected);
        choosePlantCard.classList.add("hidden");
        showPlantCard(selected);
        plantCard.classList.remove("hidden");
    };

    // 5. –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è —Å –ø–æ–ª–∏–≤–æ–º –∏ –ø–æ–∫—É–ø–∫–æ–π
    function showPlantCard(plantName){
        document.getElementById("plantName").innerText = plantName;
        document.getElementById("plantImage").src = plants[plantName].img;
        document.getElementById("plantDescription").innerText = plants[plantName].desc;

        // –ü–æ–ª–∏–≤
        const waterBtn = document.getElementById("waterBtn");
        const statusText = document.getElementById("statusText");
        const wateringInterval = 3;
        let lastWatered = localStorage.getItem(`${plantName}-lastWatered`);

        function updateButtonState(){
            const today=new Date();
            if(lastWatered){
                const last=new Date(lastWatered);
                const diffDays=Math.floor((today-last)/(1000*60*60*24));
                const daysLeft=wateringInterval-diffDays;
                if(daysLeft<=0){ waterBtn.disabled=false; waterBtn.style.background="#2ecc71"; statusText.innerText=""; }
                else{ waterBtn.disabled=true; waterBtn.style.background="#ccc"; statusText.innerText=`–°–ª–µ–¥—É—é—â–∏–π –ø–æ–ª–∏–≤ —á–µ—Ä–µ–∑ ${daysLeft} –¥–Ω.`; }
            }else{ waterBtn.disabled=false; waterBtn.style.background="#2ecc71"; statusText.innerText=""; }
        }

        waterBtn.onclick = ()=>{
            const today=new Date().toISOString().slice(0,10);
            localStorage.setItem(`${plantName}-lastWatered`, today);
            lastWatered=today;
            waterBtn.disabled=true;
            waterBtn.style.background="#ccc";
            statusText.innerText=`–°–ª–µ–¥—É—é—â–∏–π –ø–æ–ª–∏–≤ —á–µ—Ä–µ–∑ ${wateringInterval} –¥–Ω. üå±`;
        };

        updateButtonState();

        // –ü–æ–∫—É–ø–∫–∞
        purchaseContainer.innerHTML="";
        if(purchaseLinks[plantName]){
            purchaseLinks[plantName].forEach(item=>{
                const div = document.createElement("div");
                div.className="purchase-option";
                div.onclick = ()=> window.open(item.url, "_blank");
                div.innerHTML = `<img src="${item.img}" alt="${item.name}"><span>${item.name}</span>`;
                purchaseContainer.appendChild(div);
            });
        }
    }
});
</script>
</body>
</html>


