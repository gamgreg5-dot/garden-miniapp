<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Mini-garden üå±</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; background:#f4f6f5; color:#1c1c1c;}
.container { padding:20px; max-width:420px; margin:0 auto; }
.card { background:#fff; border-radius:16px; padding:16px; margin-bottom:16px; box-shadow:0 8px 20px rgba(0,0,0,0.06);}
.plant-image { width:100%; border-radius:14px; margin-bottom:12px;}
h1 { margin:0 0 8px; font-size:22px;}
.description { font-size:14px; color:#555;}
.care-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px;}
.care-item { background:#f7f9f8; border-radius:12px; padding:12px; font-size:14px;}
.care-item span { display:block; font-size:18px; margin-bottom:4px;}
.button { width:100%; padding:14px; border-radius:14px; border:none; font-size:16px; background:#2ecc71; color:white; cursor:pointer; margin-top:8px;}
.button:active { transform:scale(0.98);}
.status { margin-top:10px; font-size:14px; color:#2ecc71; text-align:center;}
.hidden { display:none; }
select,input[type="radio"] { width:100%; padding:10px; border-radius:10px; font-size:16px; margin-top:8px;}
label { font-size:14px; margin-top:10px; display:block;}
</style>
</head>
<body>
<div class="container">

<!-- 1. –í—ã–±–æ—Ä –µ—Å—Ç—å —Ü–≤–µ—Ç–æ–∫ -->
<div class="card" id="havePlantCard">
<h1>–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Ü–≤–µ—Ç–æ–∫?</h1>
<button class="button" id="havePlantYes">–î–∞ üå±</button>
<button class="button" id="havePlantNo">–ù–µ—Ç ‚ùå</button>
</div>

<!-- 2. –ï—Å–ª–∏ –î–∞: –≤—ã–±–æ—Ä —Ä–∞—Å—Ç–µ–Ω–∏—è -->
<div class="card hidden" id="selectPlantCard">
<h1>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ü–≤–µ—Ç–æ–∫</h1>
<select id="plantSelect"></select>
<button class="button" id="selectPlantBtn">–í—ã–±—Ä–∞—Ç—å</button>
</div>

<!-- 3. –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è —Å –ø–æ–ª–∏–≤–æ–º -->
<div class="card hidden" id="plantCard">
<img id="plantImage" class="plant-image" src="">
<h1 id="plantName"></h1>
<div class="description" id="plantDescription"></div>
<h1>–£—Ö–æ–¥</h1>
<div class="care-grid">
<div class="care-item"><span>üíß</span>–ü–æ–ª–∏–≤: 1‚Äì2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é</div>
<div class="care-item"><span>‚òÄÔ∏è</span>–°–≤–µ—Ç: —è—Ä–∫–∏–π, –±–µ–∑ –ø—Ä—è–º—ã—Ö –ª—É—á–µ–π</div>
<div class="care-item"><span>üêæ</span>–ë–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö</div>
<div class="care-item"><span>üå°Ô∏è</span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 18‚Äì25¬∞C</div>
</div>
<button class="button" id="waterBtn">–Ø –ø–æ–ª–∏–ª —Å–µ–≥–æ–¥–Ω—è üíß</button>
<div class="status" id="statusText"></div>
</div>

<!-- 4. –¢–µ—Å—Ç –¥–ª—è –Ω–æ–≤—ã—Ö -->
<div class="card hidden" id="testCard">
<h1>–î–∞–≤–∞–π—Ç–µ –ø–æ–¥–±–µ—Ä–µ–º –≤–∞–º —Ü–≤–µ—Ç–æ–∫</h1>
<div class="description">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:</div>

<label>1. –û—Å–≤–µ—â–µ–Ω–∏–µ –≤ –∫–æ–º–Ω–∞—Ç–µ</label>
<select id="lightSelect">
<option value="bright">–Ø—Ä–∫–æ–µ</option>
<option value="medium">–°—Ä–µ–¥–Ω–µ–µ</option>
<option value="low">–¢–µ–Ω–µ–≤–æ–µ</option>
</select>

<label>2. –ï—Å—Ç—å –ª–∏ –¥–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã?</label>
<select id="petsSelect">
<option value="yes">–î–∞</option>
<option value="no">–ù–µ—Ç</option>
</select>

<label>3. –í–∞—à –æ–ø—ã—Ç —É—Ö–æ–¥–∞ –∑–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è–º–∏</label>
<select id="experienceSelect">
<option value="beginner">–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
<option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
<option value="pro">–û–ø—ã—Ç–Ω—ã–π</option>
</select>

<label>4. –£—Ä–æ–≤–µ–Ω—å –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏</label>
<select id="humiditySelect">
<option value="low">–ù–∏–∑–∫–∞—è</option>
<option value="medium">–°—Ä–µ–¥–Ω—è—è</option>
<option value="high">–í—ã—Å–æ–∫–∞—è</option>
</select>

<button class="button" id="runTestBtn">–ü–æ–¥–æ–±—Ä–∞—Ç—å —Ä–∞—Å—Ç–µ–Ω–∏–µ</button>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded", function(){
    const tg = window.Telegram?.WebApp; if(tg) tg.expand();

    const plants = {
        "Alctromeriya": {img:"images/alctromeriya.png", desc:"–Ø—Ä–∫–∏–π –Ω–µ–ø—Ä–∏—Ö–æ—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç–æ–∫."},
        "Begoniya": {img:"images/begoniya.png", desc:"–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —è—Ä–∫–∏—Ö –æ–∫–æ–Ω –∏ –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –ø–∏—Ç–æ–º—Ü–µ–≤."},
        "Koleus": {img:"images/coleus.png", desc:"–ö—Ä–∞—Å–∏–≤–æ–µ –∏ –Ω–µ–ø—Ä–∏—Ö–æ—Ç–ª–∏–≤–æ–µ –∫–æ–º–Ω–∞—Ç–Ω–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ."},
        "Gardeniya": {img:"images/gardeniya.png", desc:"–õ—é–±–∏—Ç —è—Ä–∫–∏–π —Å–≤–µ—Ç –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å."},
        "Orfid Falenopsis": {img:"images/orfid_falenopsis.png", desc:"–ö—Ä–∞—Å–∏–≤—ã–π –æ—Ä—Ö–∏–¥–µ–π —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —É—Ö–æ–¥–æ–º."},
        "Orfid Kattleya": {img:"images/orfid_kattleya.png", desc:"–î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤–æ–¥–æ–≤, –ª—é–±–∏—Ç —Å–≤–µ—Ç –∏ —Ç–µ–ø–ª–æ."}
    };

    const havePlantCard = document.getElementById("havePlantCard");
    const selectPlantCard = document.getElementById("selectPlantCard");
    const testCard = document.getElementById("testCard");
    const plantCard = document.getElementById("plantCard");
    const plantSelect = document.getElementById("plantSelect");

    // 1. –í—ã–±–æ—Ä –î–∞/–ù–µ—Ç
    document.getElementById("havePlantYes").onclick = ()=>{
        havePlantCard.classList.add("hidden");
        selectPlantCard.classList.remove("hidden");
        plantSelect.innerHTML="";
        for(let p in plants){
            let opt=document.createElement("option"); opt.value=p; opt.innerText=p;
            plantSelect.appendChild(opt);
        }
    };

    document.getElementById("havePlantNo").onclick = ()=>{
        havePlantCard.classList.add("hidden");
        testCard.classList.remove("hidden");
    };

    // 2. –í—ã–±–æ—Ä —Ä–∞—Å—Ç–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞
    document.getElementById("selectPlantBtn").onclick = ()=>{
        const selected = plantSelect.value;
        showPlantCard(selected);
        selectPlantCard.classList.add("hidden");
        plantCard.classList.remove("hidden");
    };

    // 3. –¢–µ—Å—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    document.getElementById("runTestBtn").onclick = ()=>{
        const light = document.getElementById("lightSelect").value;
        const pets = document.getElementById("petsSelect").value;
        const exp = document.getElementById("experienceSelect").value;
        const hum = document.getElementById("humiditySelect").value;

        // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–¥–±–æ—Ä–∞, –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å
        let suggested = "Koleus"; 
        if(light==="bright" && pets==="yes" && exp==="beginner") suggested="Begoniya";
        else if(light==="medium" && pets==="no" && hum==="medium") suggested="Gardeniya";
        else if(light==="low") suggested="Orfid Falenopsis";
        else if(exp==="pro" && light==="bright") suggested="Orfid Kattleya";
        else if(light==="bright" && exp==="medium") suggested="Alctromeriya";

        testCard.classList.add("hidden");
        showPlantCard(suggested);
        plantCard.classList.remove("hidden");
    };

    // 4. –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—Å—Ç–µ–Ω–∏—è
    function showPlantCard(plantName){
        document.getElementById("plantName").innerText = plantName;
        document.getElementById("plantImage").src = plants[plantName].img;
        document.getElementById("plantDescription").innerText = plants[plantName].desc;

        const waterBtn = document.getElementById("waterBtn");
        const statusText = document.getElementById("statusText");
        const wateringInterval = 3;
        let lastWatered = localStorage.getItem(`${plantName}-lastWatered`);

        function updateButtonState(){
            const today=new Date();
            if(lastWatered){
                const last=new Date(lastWatered);
                const diffDays=Math.floor((today-last)/(1000*60*60*24));
                const daysLeft=wateringInterval-diffDays;
                if(daysLeft<=0){ waterBtn.disabled=false; waterBtn.style.background="#2ecc71"; statusText.innerText=""; }
                else{ waterBtn.disabled=true; waterBtn.style.background="#ccc"; statusText.innerText=`–°–ª–µ–¥—É—é—â–∏–π –ø–æ–ª–∏–≤ —á–µ—Ä–µ–∑ ${daysLeft} –¥–Ω.`; }
            }else{ waterBtn.disabled=false; waterBtn.style.background="#2ecc71"; statusText.innerText=""; }
        }

        waterBtn.onclick = ()=>{
            const today=new Date().toISOString().slice(0,10);
            localStorage.setItem(`${plantName}-lastWatered`, today);
            lastWatered=today;
            waterBtn.disabled=true;
            waterBtn.style.background="#ccc";
            statusText.innerText=`–°–ª–µ–¥—É—é—â–∏–π –ø–æ–ª–∏–≤ —á–µ—Ä–µ–∑ ${wateringInterval} –¥–Ω. üå±`;
        };

        updateButtonState();
    }
});
</script>
</body>
</html>
